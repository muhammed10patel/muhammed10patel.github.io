<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Automatic Whale Detection Using Deep Learning | Muhammed Patel </title> <meta name="author" content="Muhammed Patel"> <meta name="description" content="Leveraging state-of-the-art deep learning techniques for automated whale detection."> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://muhammedpatel.com/projects/3_project/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <link rel="stylesheet" href="/assets/css/photoviewer.css"> <script src="https://cdn.jsdelivr.net/npm/photoviewer/dist/photoviewer.min.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Muhammed</span> Patel </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Automatic Whale Detection Using Deep Learning</h1> <p class="post-description">Leveraging state-of-the-art deep learning techniques for automated whale detection.</p> </header> <article> <h3 id="highlights">Highlights</h3> <ul> <li>Developed an automated whale detection model on Survey Data from Fisheries and Oceans, Canada (DFO)</li> <li>Tested different SOTA models like Deformable Detr, Yolov8, and backbones like VMamaba, ConvNext-T and Swin_T</li> <li>Systematically analyzed patch sizes (256–4096 pixels) and found patch size 4096 to be best</li> <li>Achieved an AP@IoU=0.1 of 0.878, using ConvNext with FasterRCNN</li> <li>Addressed domain adaptation challenges using active learning on new survey 2023 data</li> <li>Shipped the model into the production via Labelstudio and is currently used by DFO to annotate their new data</li> </ul> <hr> <div class="project-gallery row text-center"> <div class="col-sm mt-3 mt-md-0"> <img src="/assets/img/project3/survey_location.png" alt="Survey location" data-title="Survey location in Canadian Arctic" class="img-fluid rounded z-depth-1" style="width: 35%; height: auto;"> </div> </div> <div class="caption"> Survey location in Canadian Arctic </div> <h4 id="dataset">Dataset</h4> <p> The dataset is collected over four different years(2014, 2015, 2016 and 2017) at Canadian Arcitc and contains two species: Beluga and Narval. The above figure shows the locations of survey. The dataset is particularly challenging because there is so much variability in the dataset. Factors such as time of day, wind speed, weather conditions, swell size, sediment, viewing angle, and water turbidity affect the visibility and appearance of the belugas and narwhals. </p> <div id="gallery1" class="project-gallery row text-center"> <div class="col-md-6 col-sm-12 mt-3"> <img src="/assets/img/project3/140803_Cam2_00779.jpg" alt="Image 1" data-title="2014 Dataset" data-alt-src="/assets/img/project3/140803_Cam2_00779_bbox.jpg" class="img-fluid rounded z-depth-1"> </div> <div class="col-md-6 col-sm-12 mt-3"> <img src="/assets/img/project3/20150818_25mm_002230.jpg" alt="Image 2" data-title="2015 Dataset" data-alt-src="/assets/img/project3/20150818_25mm_002230_bbox.jpg" class="img-fluid rounded z-depth-1"> </div> <div class="col-md-6 col-sm-12 mt-3"> <img src="/assets/img/project3/ES_20160821_25mm_02317.jpg" alt="Image 3" data-title="2016 Dataset" data-alt-src="/assets/img/project3/ES_20160821_25mm_02317_bbox.jpg" class="img-fluid rounded z-depth-1"> </div> <div class="col-md-6 col-sm-12 mt-3"> <img src="/assets/img/project3/20170729_CF_2001081.jpg" alt="Image 4" data-title="2017 Dataset" data-alt-src="/assets/img/project3/20170729_CF_2001081_bbox.jpg" class="img-fluid rounded z-depth-1"> </div> </div> <div id="gallery1-container" class="text-center"> <button class="toggle-button btn btn-primary btn-sm" data-gallery="gallery1" data-toggled="false">Show Predictions</button> </div> <div class="gallery-caption text-center mt-3"> <p style="font-size: 12px; color: #555;"> These images show the heterogeneous nature of the dataset. Prediction from the Best model is shown across datasets from different years. Click on individual images to zoom in. Click on the toggle button to show or remove prediction. Box color coding; TP: <span style="color: green;">Green</span>, FP: <span style="color: red;">Red</span>, FN: <span style="color: blue;">Blue</span>. </p> </div> <p> The dataset, as illustrated in the above figures, contains significant background noise, including elements such as waves and sunglare that closely resemble the appearance of whales. Therefore context is really important when discerning whales other noises. The below figure illustrates the significance of contextual information in an image affected by sunglare. </p> <div class="project-gallery row text-center"> <div class="col-sm mt-3 mt-md-0"> <img src="/assets/img/project3/patches.png" alt="Survey location" data-title="Patches from size 256-4096 highliting importance of the context" class="img-fluid rounded z-depth-1" style="width: 100%; height: auto;"> </div> </div> <div class="caption"> <p style="font-size: 12px; color: #555;"> Patches from size 256 to 4096. Orientation of the waves is critical to discern whales from waves. </p> </div> <h4 id="experimental-design">Experimental design</h4> <p>First we start with three main family of objection detection architectures: FasterRCNN, YOLO and DeTr. Next we pair them up with 4 different backbone architecture namely: Resnet50, Swin-T, ConvNext-T and Vmamba. These backbones were chosen because of their varying receptive field. The below figure shows the receptive field of different backbone architectures.</p> <div class="project-gallery row text-center"> <div class="col-sm mt-3 mt-md-0"> <img src="/assets/img/project3/receptive_field.png" alt="Survey location" data-title="Effective Receptive Fields (ERF) between different backbone models." class="img-fluid rounded z-depth-1" style="width: 50%; height: auto;"> </div> </div> <div class="caption"> <p style="font-size: 12px; color: #555;"> Effective Receptive Fields (ERF) between different backbone models. Figure adapted from <a href="https://arxiv.org/abs/2401.10166" target="_blank" style="color: #007bff; text-decoration: none;" rel="external nofollow noopener">Zhu et al., 2024</a>, used under CC BY 4.0. </p> </div> <p> Therefore in the experimental design, we aim to: </p> <ol type="a" style="padding-left: 20px;"> <li>Determine the optimal patch size that balances contextual information and computational efficiency.</li> <li>Assess how different object detection models handle the complexities of whale detection in aerial imagery.</li> <li>Evaluate the effectiveness of various backbone architectures in extracting relevant features for whale detection.</li> <li>Identify the optimal configuration for operational deployment in marine mammal monitoring programs conducted by the DFO.</li> </ol> <h4 id="result">Result</h4> <p>The below table shows the \(mAP_{IoU=10\%}\) the performance of all the experiments. As can be seen the, FasterRCNN model, with ConvNext-T backbone performs best.</p> <table style="border-collapse: collapse; width: 100%; text-align: center;"> <thead> <tr style="border: 1px solid black;"> <th style="border: 1px solid black;"># Params</th> <th style="border: 1px solid black;">Model</th> <th style="border: 1px solid black;">Backbone</th> <th style="border: 1px solid black;">Patch size 256</th> <th style="border: 1px solid black;">Patch size 512</th> <th style="border: 1px solid black;">Patch size 1024</th> <th style="border: 1px solid black;">Patch size 2048</th> <th style="border: 1px solid black;">Patch size 4096</th> <th style="border: 1px solid black;">resize 50%</th> </tr> </thead> <tbody> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">40.10M</td> <td style="border: 1px solid black;">Deformable DETR</td> <td style="border: 1px solid black;">ResNet-50</td> <td style="border: 1px solid black;">0.794</td> <td style="border: 1px solid black;">0.820</td> <td style="border: 1px solid black;">0.847</td> <td style="border: 1px solid black;">0.761</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">0.318</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">38.84M</td> <td style="border: 1px solid black;">Deformable DETR</td> <td style="border: 1px solid black;">Swin-T</td> <td style="border: 1px solid black;">0.00</td> <td style="border: 1px solid black;">0.841</td> <td style="border: 1px solid black;">0.828</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">40.80M</td> <td style="border: 1px solid black;">Deformable DETR</td> <td style="border: 1px solid black;">VMamba-T</td> <td style="border: 1px solid black;">0.775</td> <td style="border: 1px solid black;">0.788</td> <td style="border: 1px solid black;">LDC</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">39.15M</td> <td style="border: 1px solid black;">Deformable DETR</td> <td style="border: 1px solid black;">ConvNext-T</td> <td style="border: 1px solid black;">0.812</td> <td style="border: 1px solid black;">0.833</td> <td style="border: 1px solid black;">0.832</td> <td style="border: 1px solid black;">0.741</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">41.35M</td> <td style="border: 1px solid black;">FasterRCNN</td> <td style="border: 1px solid black;">ResNet-50</td> <td style="border: 1px solid black;">0.746</td> <td style="border: 1px solid black;">0.810</td> <td style="border: 1px solid black;">0.833</td> <td style="border: 1px solid black;">0.843</td> <td style="border: 1px solid black;">0.840</td> <td style="border: 1px solid black;">0.663</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">44.75M</td> <td style="border: 1px solid black;">FasterRCNN</td> <td style="border: 1px solid black;">Swin-T</td> <td style="border: 1px solid black;">0.793</td> <td style="border: 1px solid black;">0.841</td> <td style="border: 1px solid black;"><b>0.863</b></td> <td style="border: 1px solid black;"><b>0.860</b></td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">46.71M</td> <td style="border: 1px solid black;">FasterRCNN</td> <td style="border: 1px solid black;">VMamba-T</td> <td style="border: 1px solid black;">0.772</td> <td style="border: 1px solid black;">0.788</td> <td style="border: 1px solid black;">0.818</td> <td style="border: 1px solid black;">0.802</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">45.05M</td> <td style="border: 1px solid black;">FasterRCNN</td> <td style="border: 1px solid black;">ConvNext</td> <td style="border: 1px solid black;">0.784</td> <td style="border: 1px solid black;">0.834</td> <td style="border: 1px solid black;"><b>0.861</b></td> <td style="border: 1px solid black;"><b>0.878</b></td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">11.14M</td> <td style="border: 1px solid black;">Yolov8-s</td> <td style="border: 1px solid black;">Yolov8CSPDarkNet</td> <td style="border: 1px solid black;">0.747</td> <td style="border: 1px solid black;">0.791</td> <td style="border: 1px solid black;">0.812</td> <td style="border: 1px solid black;">0.645</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> <tr style="border: 1px solid black;"> <td style="border: 1px solid black;">43.69M</td> <td style="border: 1px solid black;">Yolov8-l</td> <td style="border: 1px solid black;">Yolov8CSPDarkNet</td> <td style="border: 1px solid black;">0.746</td> <td style="border: 1px solid black;">0.804</td> <td style="border: 1px solid black;">0.802</td> <td style="border: 1px solid black;">0.731</td> <td style="border: 1px solid black;">NP</td> <td style="border: 1px solid black;">NP</td> </tr> </tbody> </table> <div style="text-align: left;"> <iframe src="/assets/img/project3/plot_final.html" width="1200" height="600" style="border:none;"> </iframe> </div> <h4 id="adapting-to-new-domain-active-learning">Adapting to new domain: Active learning</h4> <div class="project-gallery row text-center"> <div class="col-sm mt-3 mt-md-0"> <img src="/assets/img/project3/differences_in_new_data.png" alt="Survey location" data-title="Effective Receptive Fields (ERF) between different backbone models." class="img-fluid rounded z-depth-1" style="width: 50%; height: auto;"> </div> </div> <div class="caption"> <p style="font-size: 12px; color: #555;"> Differrences between old and new surveys. </p> </div> <p>In real world, the distribution of the dataset changes continously. This happened with our partner, DFO in their newly captured survey. Their new survey contains images with ice, new species and different size of the whale. To adress this, we use active learning which is a human-in-the-loop approach where few images are sampled from the unlabelled set such that the performance of the model will be maximized if trained on the new sample. We deploy this active learning pipeline using <a href="https://labelstud.io/" target="_blank" style="color: #007bff; text-decoration: none;" rel="external nofollow noopener">Labelstudio</a>, where model’s prediction is continously refined by a human annotator.</p> <p>Below video shows an example image annotated and corrected using labelstudio. This workflow is moved into production and is currently utilzed by DFO for their annotation of the new survey. </p> <div style="text-align: center;"> <img src="/assets/img/project3/label_studio.gif" alt="Model Demo" style="width: 80%; border: 1px solid #ddd; border-radius: 5px;"> </div> </article> <h2>References</h2> <div class="publications"> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Muhammed Patel. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.min.js" integrity="sha256-rjmgmaB99riUNcdlrDtcAiwtLIojSxNyUFdl+Qh+rB4=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?fa0110e8b42cec56ce96d912fd4bde74"></script> <script>addBackToTop();</script> <script src="/assets/js/photoviewer.js"></script> </body> </html>